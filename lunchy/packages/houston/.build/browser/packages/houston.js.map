{"version":3,"file":"\\packages\\houston.js","sources":["houston/client\\admin_login.html","houston/client\\db_view.html","houston/client\\collection_view.html","houston/client\\document_view.html","houston/client\\admin_navbar.html","houston/client\\main.html","houston\\client\\router.coffee","houston\\client\\admin_login.coffee","houston\\client\\collection_view.coffee","houston\\client\\document_view.coffee","houston\\client\\zma_helpers.coffee","houston\\client\\admin_navbar.coffee","houston\\client\\db_view.coffee","houston\\lib\\collections.coffee","houston\\lib\\shared.coffee"],"names":[],"mappings":"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","sourcesContent":["Template.__define__(\"_houston_login\",Package.handlebars.Handlebars.json_ast_to_func([\"<div class=\\\"houston\\\">\\r\\n    \",[\"#\",[[0,\"if\"],[0,\"loggingIn\"]],[\"\\r\\n      \",[\">\",\"spinner\"],\"\\r\\n    \"],[\"\\r\\n      \",[\">\",\"_houston_navbar\"],\"\\r\\n      <div class=\\\"container content\\\">\\r\\n        \",[\"#\",[[0,\"if\"],[0,\"logged_in\"]],[\"\\r\\n          <h1>Currently logged in</h1>\\r\\n          <div>\\r\\n            \",[\"#\",[[0,\"unless\"],[0,\"admin_user_exists\"]],[\"\\r\\n              <a class=\\\"become-houston-admin btn\\\" href=\\\"#\\\">Claim Admin</a>\\r\\n            \"]],\"\\r\\n            <a class=\\\"houston-logout btn\\\" href=\\\"#\\\">Log out</a>\\r\\n          </div>\\r\\n          \"],[\"\\r\\n            \",\"\\r\\n            <h1>\\r\\n              \",[\"#\",[[0,\"if\"],[0,\"admin_user_exists\"]],[\" Log In \"],[\" Create an admin account \"]],\"\\r\\n            </h1>\\r\\n            <form id=\\\"houston-sign-in-form\\\">\\r\\n              <div class='control-group'>\\r\\n                <label class='control-label' for='houston-email'>Email</label>\\r\\n                <div class='controls'>\\r\\n                  <input name=\\\"houston-email\\\" id='houston-email' type=\\\"text\\\">\\r\\n                </div>\\r\\n              </div>\\r\\n              <div class='control-group'>\\r\\n                <label class='control-label' for='password'>Password</label>\\r\\n                <div class='controls'>\\r\\n                  <input name=\\\"houston-password\\\" id='houston-password' type=\\\"password\\\">\\r\\n                </div>\\r\\n              </div>\\r\\n              <div>\\r\\n                <input class=\\\"btn\\\" type=\\\"submit\\\" value=\\\"Sign \",[\"#\",[[0,\"if\"],[0,\"admin_user_exists\"]],[\"in\"],[\"up\"]],\"\\\">\\r\\n              </div>\\r\\n            </form>\\r\\n        \"]],\"\\r\\n      </div>\\r\\n    \"]],\"\\r\\n  </div>\"]));\n","Template.__define__(\"_houston_db_view\",Package.handlebars.Handlebars.json_ast_to_func([\"<div class=\\\"houston\\\">\\r\\n    \",[\"#\",[[0,\"if\"],[0,\"loggingIn\"]],[\"\\r\\n      \",[\">\",\"spinner\"],\"\\r\\n    \"],[\"\\r\\n      \",[\">\",\"_houston_navbar\"],\"\\r\\n      <div class=\\\"container content\\\">\\r\\n        <ul class=\\\"breadcrumb\\\">\\r\\n          <li class=\\\"active\\\">Home</li>\\r\\n        </ul>\\r\\n        \",[\"#\",[[0,\"unless\"],[0,\"collections\"]],[\"\\r\\n          <p class=\\\"lead\\\">If this is your first time using Houston, you may need to <a id=\\\"refresh\\\" class=\\\"btn btn-large btn-warning\\\">Refresh this page</a></p>\\r\\n        \"]],\"\\r\\n        <table class='table table-bordered table-striped'>\\r\\n          <thead>\\r\\n            <tr>\\r\\n              <th>Collection Name</th>\\r\\n              <th>Number of Records</th>\\r\\n            </tr>\\r\\n          </thead>\\r\\n          <tbody>\\r\\n            \",[\"#\",[[0,\"each\"],[0,\"collections\"]],[\"\\r\\n            <tr>\\r\\n              <td><a href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_collection\"]],\"\\\">\",[\"{\",[[0,\"name\"]]],\"</a></td>\\r\\n              <td>\",[\"{\",[[0,\"num_of_records\"]]],\"</td>\\r\\n            </tr>\\r\\n            \"]],\"\\r\\n          </tbody>\\r\\n        </table>\\r\\n      </div>\\r\\n    \"]],\"\\r\\n  </div>\"]));\n","Template.__define__(\"_houston_collection_view\",Package.handlebars.Handlebars.json_ast_to_func([\"<div class=\\\"houston\\\">\\r\\n    \",[\"#\",[[0,\"if\"],[0,\"loggingIn\"]],[\"\\r\\n      \",[\">\",\"spinner\"],\"\\r\\n    \"],[\"\\r\\n      \",[\">\",\"_houston_navbar\"],\"\\r\\n      <div class=\\\"container content\\\">\\r\\n        <ul class=\\\"breadcrumb\\\">\\r\\n          <li><a href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_home\"]],\"\\\" class=\\\"houston-home\\\">Home</a> <span class=\\\"divider\\\">/</span></li>\\r\\n          <li class=\\\"active\\\">\",[\"{\",[[0,\"name\"]]],\"</li>\\r\\n        </ul>\\r\\n        \",\"\\r\\n        <div class=\\\"row hidden hide\\\" id=\\\"houston-create-document\\\">\\r\\n          <div class=\\\"span12\\\" style=\\\"overflow-x: auto\\\">\\r\\n            <h3>Add more \",[\"{\",[[0,\"name\"]]],\"</h3>\\r\\n            <table class=\\\"table table-bordered table-striped\\\">\\r\\n              <thead>\\r\\n                <tr>\\r\\n                  \",[\"#\",[[0,\"each\"],[0,\"nonid_headers\"]],[\"\\r\\n                    <th><a href=\\\"#\\\" class=\\\"sort\\\">\",[\"{\",[[0]]],\"</a></th>\\r\\n                  \"]],\"\\r\\n                  <th>Action</th>\\r\\n                </tr>\\r\\n              </thead>\\r\\n              <tbody>\\r\\n                <tr id=\\\"houston-create-row\\\">\\r\\n                  \",[\"#\",[[0,\"each\"],[0,\"nonid_headers\"]],[\"\\r\\n                    <th>\\r\\n                      <input name=\\\"\",[\"{\",[[0]]],\"\\\" class=\\\"input-small\\\" type=\\\"text\\\" />\\r\\n                    </th>\\r\\n                  \"]],\"\\r\\n                  <td><div class=\\\"btn btn-success houston-create-doc\\\">Create</div></td>\\r\\n                </tr>\\r\\n              </tbody>\\r\\n            </table>\\r\\n          </div>\\r\\n        </div>\\r\\n        <div class=\\\"row\\\">\\r\\n            <div class=\\\"span12\\\">\\r\\n                <div class=\\\"page-header\\\">\\r\\n                  <button id=\\\"houston-create-btn\\\" class=\\\"btn btn-success pull-right\\\">Add \",[\"{\",[[0,\"name\"]]],\"</button>\\r\\n                  <h1>\",[\"{\",[[0,\"name\"]]],\" (\",[\"{\",[[0,\"num_of_records\"]]],\" record\",[\"{\",[[0,\"pluralize\"]]],\")</h1>\\r\\n                </div>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class='row'>\\r\\n            <div class=\\\"span10\\\" style=\\\"overflow-x: auto\\\">\\r\\n                <table class=\\\"table table-bordered table-striped table-hover\\\">\\r\\n                  <thead>\\r\\n                    <tr>\\r\\n                      \",[\"#\",[[0,\"each\"],[0,\"headers\"]],[\"\\r\\n                        <th><a href=\\\"#\\\" class=\\\"houston-sort\\\">\",[\"{\",[[0]]],\"</a></th>\\r\\n                      \"]],\"\\r\\n                      <th>Action</th>\\r\\n                    </tr>\\r\\n                  </thead>\\r\\n                  <tbody>\\r\\n                    \",[\"#\",[[0,\"each\"],[0,\"rows\"]],[\"\\r\\n                      <tr>\\r\\n                        <td><a href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_document\"]],\"\\\">\",[\"{\",[[0,\"_id\"]]],\"</a></td>\\r\\n                        \",[\"#\",[[0,\"each\"],[0,\"values_in_order\"]],[\"\\r\\n                          <td data-field='\",[\"{\",[[0,\"field_name\"]]],\"' class='houston-collection-field'>\",[\"{\",[[0,\"field_value\"]]],\"</td>\\r\\n                        \"]],\"\\r\\n                        <td><div data-id=\\\"\",[\"{\",[[0,\"_id\"]]],\"\\\" class=\\\"btn houston-delete-doc btn-danger\\\">Delete</div></td>\\r\\n                      </tr>\\r\\n                    \"]],\"\\r\\n                  </tbody>\\r\\n                </table>\\r\\n          </div>\\r\\n          <div class=\\\"span2\\\">\\r\\n            <form>\\r\\n                <legend>Filter</legend>\\r\\n                \",[\"#\",[[0,\"each\"],[0,\"nonid_headers\"]],[\"\\r\\n                <label>\",[\"{\",[[0]]],\"</label>\\r\\n                <input name=\\\"\",[\"{\",[[0]]],\"\\\" class=\\\"houston-column-filter input-small\\\" type=\\\"text\\\" value=\\\"\",[\"{\",[[0,\"filter_value\"]]],\"\\\"/>\\r\\n                \"]],\"\\r\\n            </form>\\r\\n          </div>\\r\\n      </div>\\r\\n    \"]],\"\\r\\n  </div>\"]));\n","Template.__define__(\"_houston_document_view\",Package.handlebars.Handlebars.json_ast_to_func([\"<div class=\\\"houston\\\">\\r\\n    \",[\"#\",[[0,\"if\"],[0,\"loggingIn\"]],[\"\\r\\n      \",[\">\",\"spinner\"],\"\\r\\n    \"],[\"\\r\\n      \",[\">\",\"_houston_navbar\"],\"\\r\\n      <div class=\\\"container content\\\">\\r\\n        <ul class=\\\"breadcrumb\\\">\\r\\n          <li>\\r\\n            <a href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_home\"]],\"\\\" class=\\\"houston-home\\\">Home</a>\\r\\n            <span class=\\\"divider\\\">/</span>\\r\\n          </li>\\r\\n          <li>\\r\\n            <a href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_collection\"]],\"\\\" class=\\\"houston-collection\\\">\",[\"{\",[[0,\"name\"]]],\"</a>\\r\\n            <span class=\\\"divider\\\">/</span>\\r\\n          </li>\\r\\n          <li class=\\\"active\\\">\",[\"{\",[[0,\"document_id\"]]],\"</li>\\r\\n        </ul>\\r\\n        <h1>\",[\"{\",[[0,\"document_id\"]]],\"</h1>\\r\\n        <div id=\\\"doc-saved\\\" class=\\\"alert alert-success \",[\"{\",[[0,\"adminHide\"]]],\"\\\">Your document was saved!</div>\\r\\n        <table class='table'>\\r\\n          <tbody>\\r\\n            \",[\"#\",[[0,\"each\"],[0,\"fields\"]],[\"\\r\\n              \",[\">\",\"_houston_document_field\"],\"\\r\\n            \"]],\"\\r\\n          </tbody>\\r\\n        </table>\\r\\n        <span class=\\\"btn houston-save\\\">Save</span>\\r\\n        <span class=\\\"btn houston-delete\\\">Delete</span>\\r\\n      </div>\\r\\n    \"]],\"\\r\\n  </div>\"]));\nTemplate.__define__(\"_houston_document_field\",Package.handlebars.Handlebars.json_ast_to_func([\"<tr>\\r\\n    <td>\",[\"{\",[[0,\"name\"]]],\":</td>\\r\\n    \",[\"#\",[[0,\"if\"],[0,\"field_is_id\"]],[\"\\r\\n    <td>\",[\"{\",[[0,\"value\"]]],\"</td>\\r\\n    \"],[\"\\r\\n    <td><textarea class=\\\"houston-field\\\" name=\\\"\",[\"{\",[[0,\"name\"]]],\"\\\">\",[\"{\",[[0,\"value\"]]],\"</textarea></td>\\r\\n    \"]],\"\\r\\n  </tr>\"]));\n","Template.__define__(\"_houston_navbar\",Package.handlebars.Handlebars.json_ast_to_func([\"<div class=\\\"houston\\\">\\r\\n    <div class=\\\"navbar navbar-fixed-top\\\">\\r\\n      <div class=\\\"navbar-inner\\\">\\r\\n        <div class=\\\"container\\\">\\r\\n          <button type=\\\"button\\\" class=\\\"btn btn-navbar\\\" data-toggle=\\\"collapse\\\" data-target=\\\".nav-collapse\\\">\\r\\n            <span class=\\\"icon-bar\\\"></span>\\r\\n            <span class=\\\"icon-bar\\\"></span>\\r\\n            <span class=\\\"icon-bar\\\"></span>\\r\\n          </button>\\r\\n          <a class=\\\"brand\\\" href=\\\"\",[\"{\",[[0,\"pathFor\"],\"houston_home\"]],\"\\\">Admin</a>\\r\\n          <div class=\\\"nav-collapse collapse\\\">\\r\\n            <ul class=\\\"nav\\\">\\r\\n            </ul>\\r\\n          </div>\\r\\n          <ul class=\\\"nav pull-right\\\">\\r\\n            <li>\\r\\n              <a id=\\\"houston-report-bug\\\" href=\\\"\",[\"{\",[[0,\"bugreport_url\"]]],\"\\\" target=\\\"_blank\\\">Report a Bug</a>\\r\\n            </li>\\r\\n            \",[\"#\",[[0,\"if\"],[0,\"currentUser\"]],[\"\\r\\n              <li>\\r\\n                <a class=\\\"houston-logout\\\" href=\\\"#\\\">Log out</a>\\r\\n              </li>\\r\\n            \"]],\"\\r\\n          </ul>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\"]));\n","Meteor.startup(function(){document.body.appendChild(Spark.render(Template.__define__(null,Package.handlebars.Handlebars.json_ast_to_func([[\"#\",[[0,\"if\"],[0,\"onHoustonPage\"]],[\"\\r\\n    \",[\"{\",[[0,\"renderPage\"]]],\"\\r\\n    <div class='row'>\\r\\n      <div class='small-12 columns' id='footer'>\\r\\n        <ul>\\r\\n        </ul>\\r\\n      </div>\\r\\n    </div>\\r\\n  \"]]]))));});","window.Houston ?= {}\r\n\r\nHouston._houstonize = (name) -> \"_houston_#{name}\"\r\n\r\nHouston._subscribe = (name) -> Meteor.subscribe Houston._houstonize name\r\n\r\nHouston._subscribe 'collections'\r\nHouston._subscribe 'admin_user'\r\n\r\nsetup_collection = (collection_name, document_id) ->\r\n  Houston._page_length = 20\r\n  subscription_name = Houston._houstonize collection_name\r\n  collection = Houston._get_collection(collection_name)\r\n  filter = if document_id\r\n    # Sometimes you can lookup with _id being a string, sometimes not\r\n    # When id can be wrapped in an ObjectID, it should\r\n    # It can't if it isn't 12 bytes (24 characters)\r\n    if typeof(document_id) == 'string' and document_id.length == 24\r\n      document_id = new Meteor.Collection.ObjectID(document_id)\r\n    {_id: document_id}\r\n  else\r\n    {}\r\n  Houston._paginated_subscription =\r\n    Meteor.subscribeWithPagination subscription_name, {}, filter,\r\n      Houston._page_length\r\n  Houston._session('collection_name', collection_name)\r\n  return [collection, Houston._paginated_subscription]\r\n\r\nHouston._houstonize_route = (name) -> Houston._houstonize(name)[1..]\r\n\r\nHouston._go = (route_name, options) ->\r\n  Router.go Houston._houstonize_route(route_name), options\r\n\r\n\r\nRouter.map ->\r\n  houston_route = (route_name, options) =>\r\n    # Append _houston_ to template and route names to avoid clobbering parent route namespace\r\n    options.template = Houston._houstonize(options.template)\r\n    options.layoutTemplate = null\r\n    @route Houston._houstonize_route(route_name), options\r\n\r\n  houston_route 'home',\r\n    path: '/admin',\r\n    before: ->\r\n      # TODO use wait\r\n      Houston._session 'collections', Houston._collections.collections.find().fetch()\r\n    template: 'db_view'\r\n\r\n  houston_route 'login',\r\n    path: '/admin/login',\r\n    template: 'login'\r\n\r\n  houston_route 'collection',\r\n    path: '/admin/:name'\r\n    data: ->\r\n      [collection, @subscription] = setup_collection(@params.name)\r\n      {collection}\r\n    waitOn: -> @subscription\r\n    template: 'collection_view'\r\n\r\n  houston_route 'document',\r\n    path: '/admin/:collection/:_id'\r\n    data: ->\r\n      Houston._session('document_id', @params._id)\r\n      [collection, @subscription] = setup_collection(\r\n        @params.collection, @params._id)\r\n      {collection, name: @params.collection}\r\n    template: 'document_view'\r\n\r\n# ########\r\n# filters\r\n# ########\r\nmustBeAdmin = ->\r\n  unless Meteor.loggingIn() # don't check for admin user until ready\r\n    unless Houston._user_is_admin Meteor.userId()\r\n      @stop()\r\n      Houston._go 'login'\r\n\r\n# If the host app doesn't have a router, their html may show up\r\nhide_non_admin_stuff = ->\r\n  $('body').hide()\r\n  func = ->\r\n    $('body').show()\r\n    $('body').children().hide()\r\n    $('body>.houston').show()\r\n    $('body').css('visibility','hidden')\r\n    $('body>.houston').css('visibility', 'visible')\r\n  setTimeout func, 0\r\n\r\nremove_host_css = ->\r\n  # Houston._css_files is set in client/zma_helpers.coffee\r\n  is_houston_link = ($link) ->\r\n    $link.attr('href') in Houston._css_files\r\n  links = $('link[rel=\"stylesheet\"]')\r\n  for link in links\r\n    $link = $(link)\r\n    unless is_houston_link($link)\r\n      $link.remove()\r\n\r\n  links = $('link[rel=\"stylesheet\"]')\r\n  # when hitting a new path using one of our links (as opposed to hitting a url directly)\r\n  # the head tag is not reloaded, so it's possible that our css files are already\r\n  # in the head tag.\r\n  # Therefore, if after removing all of the non-houston css files, there are the\r\n  # same number of files as in Houston._css_files, all of our files are in there,\r\n  # so there is no need to add them again.\r\n  if links.length < Houston._css_files.length\r\n    $head = $('head')\r\n    for file in Houston._css_files\r\n      $head.append(\"<link rel=\\\"stylesheet\\\" href=\\\"#{file}\\\">\")\r\n\r\n\r\nRouter.before mustBeAdmin,\r\n  only: (Houston._houstonize_route(name) for name in ['home', 'collection', 'document'])\r\nRouter.after hide_non_admin_stuff,\r\n  only: (Houston._houstonize_route(name) for name in ['home', 'collection', 'document', 'login'])\r\nRouter.before remove_host_css,\r\n  only: (Houston._houstonize_route(name) for name in ['home', 'collection', 'document', 'login'])\r\n\r\nonRouteNotFound = Router.onRouteNotFound\r\nRouter.onRouteNotFound = (args...) ->\r\n  non_houston_routes = _.filter(Router.routes, (route) -> route.name.indexOf('houston_') != 0)\r\n  if non_houston_routes.length > 0\r\n    onRouteNotFound(args...)\r\n  else\r\n    console.log \"Note: Houston is suppressing Iron-Router errors because we don't think you are using it.\"\r\n","admin_user_exists = () -> Houston._admins.find().count() > 0\r\n\r\nTemplate._houston_login.helpers(\r\n  logged_in: -> Meteor.user()\r\n  admin_user_exists: -> admin_user_exists()\r\n)\r\n\r\nTemplate._houston_login.events(\r\n  'submit #houston-sign-in-form': (e) ->\r\n    e.preventDefault()\r\n    email = $('input[name=\"houston-email\"]').val()\r\n    password = $('input[name=\"houston-password\"]').val()\r\n\r\n    afterLogin = (error) ->\r\n      # TODO error case that properly displays\r\n      if error\r\n        alert error\r\n      else\r\n        Houston._go 'home'\r\n\r\n    if admin_user_exists()\r\n      Meteor.loginWithPassword email, password, afterLogin\r\n    else\r\n      Accounts.createUser {\r\n        email: email\r\n        password: password\r\n      }, (error) ->\r\n        return afterLogin(error) if error\r\n        # else - user got created\r\n        Houston._call('make_admin', Meteor.userId(), afterLogin)\r\n\r\n  'click .houston-logout': (e) ->\r\n    e.preventDefault()\r\n    Meteor.logout()\r\n\r\n  'click .become-houston-admin': (e) ->\r\n    e.preventDefault()\r\n    Houston._call('make_admin', Meteor.userId())\r\n    Houston._go 'home'\r\n)\r\n\r\nTemplate._houston_login.rendered = ->\r\n  $(window).unbind('scroll')\r\n","get_sort_by = ->\r\n  sort_by = {}\r\n  sort_by[Houston._session('sort_key')] = Houston._session('sort_order')\r\n  return sort_by\r\n\r\nget_filter_query = ->\r\n  # Make find query using the filter stored in the session. The regexes are\r\n  # escaped, but $regex is used so it can match anywhere in the string.\r\n  query = {}\r\n  fill_query_with_regex = (session_key) ->\r\n    return unless Houston._session(session_key)?\r\n    for key, val of Houston._session(session_key)\r\n      # From http://stackoverflow.com/questions/3115150/how-to-escape-regular-expression-special-characters-using-javascript#answer-9310752\r\n      query[key] = $regex: val.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\")\r\n  fill_query_with_regex('field_selectors')\r\n  return query\r\n\r\nresubscribe = ->\r\n  # Stop the old subscription and resubscribe with the new filter/sort\r\n  subscription_name = \"_houston_#{Houston._session('collection_name')}\"\r\n  Houston._paginated_subscription.stop()\r\n  Houston._paginated_subscription =\r\n    Meteor.subscribeWithPagination subscription_name,\r\n      get_sort_by(), get_filter_query(),\r\n      Houston._page_length\r\n\r\ncollection_info = -> Houston._collections.collections.findOne(name: Houston._session('collection_name'))\r\n\r\ncollection_count = -> collection_info()?.count\r\n\r\nTemplate._houston_collection_view.helpers\r\n  headers: -> get_collection_view_fields()\r\n  nonid_headers: -> get_collection_view_fields()[1..]\r\n  name: -> Houston._session('collection_name')\r\n  document_id: -> @_id + \"\"\r\n  num_of_records: ->\r\n    collection_count() or \"no\"\r\n  pluralize: -> 's' unless collection_count() == 1\r\n  rows: ->\r\n    collection = Houston._session('collection_name')\r\n    documents = get_current_collection()?.find(get_filter_query(), {sort: get_sort_by()}).fetch()\r\n    _.map documents, (d) ->\r\n      d.collection = collection\r\n      d._id = d._id._str or d._id\r\n      return d\r\n  values_in_order: ->\r\n    fields_in_order = get_collection_view_fields()\r\n    names_in_order = _.clone fields_in_order\r\n    values = (Houston._nested_field_lookup(@, field_name) for field_name in fields_in_order[1..])  # skip _id\r\n    ({field_value, field_name} for [field_value, field_name] in _.zip values, names_in_order[1..])\r\n  filter_value: ->\r\n    if Houston._session('field_selectors') and Houston._session('field_selectors')[@]\r\n      Houston._session('field_selectors')[@]\r\n    else\r\n      ''\r\n\r\nTemplate._houston_collection_view.rendered = ->\r\n  $win = $(window)\r\n  $win.scroll ->\r\n    if $win.scrollTop() + 300 > $(document).height() - $win.height() and\r\n      Houston._paginated_subscription.limit() < collection_count()\r\n        Houston._paginated_subscription.loadNextPage()\r\n\r\nget_current_collection = -> Houston._get_collection(Houston._session('collection_name'))\r\nget_collection_view_fields = -> collection_info()?.fields or []\r\n\r\nTemplate._houston_collection_view.events\r\n  \"click a.houston-sort\": (e) ->\r\n      e.preventDefault()\r\n      if (Houston._session('sort_key') == this.toString())\r\n        Houston._session('sort_order', Houston._session('sort_order') * - 1)\r\n      else\r\n        Houston._session('sort_key', this.toString())\r\n        Houston._session('sort_order', 1)\r\n      resubscribe()\r\n\r\n  'dblclick .houston-collection-field': (e) ->\r\n    $this = $(e.currentTarget)\r\n    $this.removeClass('houston-collection-field')\r\n    $this.html \"<input type='text' value='#{$this.text()}'>\"\r\n    $this.find('input').select()\r\n    $this.find('input').on 'blur', ->\r\n      updated_val = $this.find('input').val()\r\n      $this.html updated_val\r\n      $this.addClass('houston-collection-field')\r\n      id = $('td:first-child a', $this.parents('tr')).html()\r\n      field_name = $this.data('field')\r\n      update_dict = {}\r\n      update_dict[field_name] = updated_val\r\n      Houston._call(\"#{Houston._session('collection_name')}_update\",\r\n        id, $set: update_dict)\r\n\r\n  'keyup .houston-column-filter': (e) ->\r\n    field_selectors = {}\r\n    $('.houston-column-filter').each (idx, item) ->\r\n      if item.value\r\n        field_selectors[item.name] = item.value\r\n    Houston._session 'field_selectors', field_selectors\r\n    resubscribe()\r\n\r\n  'click #houston-create-btn': ->\r\n    $('#houston-create-document').removeClass('hide hidden')\r\n    $('#houston-create-btn').hide()\r\n\r\n  'click .houston-delete-doc': (e) ->\r\n    e.preventDefault()\r\n    id = $(e.currentTarget).data('id')\r\n    Houston._call(\"#{Houston._session('collection_name')}_delete\", id)\r\n\r\n  'click .houston-create-doc': (e) ->\r\n    e.preventDefault()\r\n    $create_row = $('#houston-create-row')\r\n    new_doc = {}\r\n    for field in $create_row.find('input[type=\"text\"]')\r\n      # Unflatten the field names (e.g. foods.app -> {foods: {app:}})\r\n      keys = field.name.split('.')\r\n      final_key = keys.pop()\r\n\r\n      doc_iter = new_doc\r\n      for key in keys\r\n        doc_iter[key] = {} unless doc_iter[key]\r\n        doc_iter = doc_iter[key]\r\n\r\n      doc_iter[final_key] = field.value\r\n\r\n      field.value = ''\r\n    Houston._call(\"#{Houston._session('collection_name')}_insert\", new_doc)\r\n\r\n  'submit form.houston-filter-form': (e) ->\r\n    e.preventDefault()\r\n","Template._houston_document_view.helpers\r\n  collection_name: -> Houston._session('collection_name')\r\n  adminHide: -> if Houston._session('should_show') then '' else 'hide'\r\n  fields: ->\r\n    document = get_collection().findOne _id: Houston._session('document_id')\r\n    unless document\r\n      try\r\n        document = get_collection().findOne _id: new Meteor.Collection.ObjectID(Houston._session('document_id'))\r\n      catch error\r\n        console.log error\r\n    fields = Houston._get_fields([document])\r\n    return (name: field.name, value: Houston._nested_field_lookup(document, field.name) for field in fields)\r\n  document_id: -> Houston._session('document_id')\r\n\r\nTemplate._houston_document_field.helpers\r\n  field_is_id: -> @name is '_id'\r\n  document_id: -> Houston._session('document_id')\r\n\r\nget_collection = -> Houston._get_collection(Houston._session('collection_name'))\r\n\r\nTemplate._houston_document_view.events\r\n  'click .houston-save': (e) ->\r\n    e.preventDefault()\r\n    old_object = get_collection().findOne _id: Houston._session('document_id')\r\n    unless old_object\r\n      try\r\n        old_object = get_collection().findOne _id: new Meteor.Collection.ObjectID(Houston._session('document_id'))\r\n      catch error\r\n        console.log error\r\n    update_dict = {}\r\n    for field in $('.houston-field')\r\n      unless field.name is '_id'\r\n        update_dict[field.name] = if typeof(old_object[field.name]) == 'number'\r\n            parseFloat(field.value)\r\n          else\r\n            field.value\r\n    Houston._call(\"#{Houston._session('collection_name')}_update\",\r\n      Houston._session('document_id'), $set: update_dict)\r\n    Houston._session('should_show', true)\r\n    setTimeout (->\r\n      Houston._session('should_show', false)\r\n    ), 1500\r\n\r\n  'click .houston-delete': (e) ->\r\n    e.preventDefault()\r\n    Houston._call(\"#{Houston._session('collection_name')}_delete\",\r\n      Houston._session('document_id'))\r\n    Houston._go 'collection', name: Houston._session('collection_name')\r\n\r\nTemplate._houston_document_view.rendered = ->\r\n  $(window).unbind('scroll')\r\n","if Handlebars?\r\n  Handlebars.registerHelper('onHoustonPage', ->\r\n    window.location.pathname.indexOf('/admin') == 0)\r\n\r\nHouston._collections ?= {}\r\n\r\n# regardless of what version of meteor we are using,\r\n# get the right LocalCollection\r\nHouston._get_collection = (collection_name) ->\r\n  unless Houston._collections[collection_name]\r\n    try\r\n      # you can only instantiate a collection once\r\n      Houston._collections[collection_name] = new Meteor.Collection(collection_name)\r\n    catch e\r\n      try\r\n        # works for 0.6.6.2+\r\n        Houston._collections[collection_name] = \\\r\n          Meteor.connection._mongo_livedata_collections[collection_name]\r\n      catch e\r\n        # old versions of meteor (older than 0.6.6.2)\r\n        Houston._collections[collection_name] =\r\n          Meteor._LocalCollectionDriver.collections[collection_name]\r\n\r\n  return Houston._collections[collection_name]\r\n\r\nHouston._session = () ->\r\n  key = Houston._houstonize(arguments[0])\r\n  if arguments.length == 1\r\n    return Session.get(key)\r\n  else if arguments.length == 2\r\n    Session.set(key, arguments[1])\r\n\r\nHouston._call = (name, args...) ->\r\n  Meteor.call(Houston._houstonize(name), args...)\r\n\r\nHouston._nested_field_lookup = (object, path) ->\r\n  return '' unless object?\r\n  return object._id._str if path =='_id'and typeof object._id == 'object'\r\n  result = object\r\n  for part in path.split(\".\")\r\n    result = result[part]\r\n    return '' unless result?  # quit if you can't find anything here\r\n  if typeof result isnt 'object' then result else ''\r\n\r\n# This is temporary until meteor supports mounting of apps.\r\n# It's so that we can remove all other css files and add our own.\r\n# To deploy new files, push to the gh-pages branch of gterrono/houston.\r\nHouston._css_files = [\"//terrono.com/houston/style.css\", \"//terrono.com/houston/bootstrap.css\"]\r\n# There isn't an obvious way to check if meteor is running in development or production\r\n# so if you want to test the css files in development, uncomment the line below\r\n# Houston._css_files = [\"/packages/houston/public/style.css\", \"/packages/houston/public/bootstrap.css\"]\r\n","Template._houston_navbar.events\r\n  'click .houston-logout': (e) ->\r\n    e.preventDefault()\r\n    Meteor.logout()\r\n\r\nTemplate._houston_navbar.helpers\r\n  'bugreport_url': ->\r\n    message = encodeURIComponent \"\"\"\r\nTo make sure we can help you quickly, please include the version of Houston\r\nyou are using, steps to replicate the issue, a description of what you were\r\nexpecting and a screenshot if relevant.\r\n\r\nThanks!\r\n\"\"\"\r\n    \"https://github.com/gterrono/houston/issues/new?body=#{message}\"\r\n","Template._houston_db_view.helpers\r\n  collections: -> Houston._session('collections')\r\n  num_of_records: -> Houston._collections.collections.findOne({name: @name}).count\r\n\r\nTemplate._houston_db_view.events\r\n  # trigger meteor session invalidation, definitely a hack\r\n  \"click #refresh\": -> window.location.reload()\r\n\r\nTemplate._houston_db_view.rendered = ->\r\n  Houston._session('field_selectors', {})\r\n  $(window).unbind('scroll')\r\n","root = exports ? this\r\n\r\nroot.Houston ?= {}\r\n\r\nHouston._collections ?= {}\r\n\r\nHouston._collections.collections = new Meteor.Collection('houston_collections')\r\n\r\nHouston._admins = new Meteor.Collection('houston_admins')\r\n\r\nHouston._user_is_admin = (id) ->\r\n  return id? and Houston._admins.findOne user_id: id\r\n","root = exports ? this\r\n\r\nroot.Houston ?= {}\r\n\r\nHouston._houstonize = (name) -> \"_houston_#{name}\"\r\n\r\nHouston._get_fields = (documents) ->\r\n  key_to_type = {_id: 'ObjectId'}\r\n  find_fields = (document, prefix='') ->\r\n    for key, value of _.omit(document, '_id')\r\n      if typeof value is 'object'\r\n        find_fields value, \"#{prefix}#{key}.\"\r\n      else if typeof value isnt 'function'\r\n        full_path_key = \"#{prefix}#{key}\"\r\n        key_to_type[full_path_key] = typeof value\r\n\r\n  for document in documents\r\n    find_fields document\r\n\r\n  (name: key, type: value for key, value of key_to_type)\r\n\r\nHouston._get_field_names = (documents) ->\r\n  _.pluck(Houston._get_fields(documents), 'name')\r\n"]}